下面是一份可直接给 CodeX 使用的完整前端项目设计文档（把你已确认的 Pre-Recipe + Recipe 自动构建 合并成一个文档），并按你要求将 Recipe 配置页 与 Run Monitor / Results / Run History & Templates 作为独立模块/页面组分开描述。

文档目标：让 CodeX/前端同事按本说明直接搭出 React 前端框架（路由、页面骨架、模块拆分、mock API），后端接口细节后续再补。

⸻

OCD 智能化平台（前端）

项目设计文档（V1）

技术栈：React（前后端分离，所有计算/算法通过 API 调用）
范围：Pre-Recipe（光谱准备） + Recipe 自动构建（策略配置） + Run Center（监控/结果/历史模板）

⸻

1. 项目背景与目标（前端视角）

1.1 背景

OCD 工程工作从光谱准备到 Recipe 建立涉及大量可视化、策略配置、试错与追溯需求。现状工具分散，过程依赖经验，难以复用与标准化。

1.2 目标

建立一个统一的 Web 平台前端，覆盖：
	•	Pre-Recipe：光谱查看、敏感性分析、TEM 切片选点、precision 检查
	•	Recipe 配置：基于 modelID 加载模型信息，配置 CD/材料/seed/fitting/TM/KPI 等策略
	•	Run Center：运行监控、断点续跑、过程记录、结果汇总、历史与模板复用

⸻

2. 设计原则

2.1 前后端解耦
	•	前端只定义“交互与展示”，所有计算与数据获取都由 API 提供
	•	所有功能板块对后端仅依赖“语义级接口”，字段细节可后续映射

2.2 工程师工作流优先
	•	支持高信息密度、多图联动、可解释性展示
	•	支持强控制能力：暂停/恢复/停止、seed 粒度控制、过程追溯

2.3 可复用与可追溯
	•	所有策略输入与运行过程应能被保存、复用、对比（模板化）

⸻

3. 整体信息架构（模块划分）

平台分为三大模块：
	1.	Home（主页）

	•	科技感主页面，作为入口与导航

	2.	Pre-Recipe（光谱准备模块）

	•	Spectrum Viewer
	•	Sensitivity Analysis
	•	TEM 切片选点工作台（含约束配置）
	•	Precision Analysis

	3.	Recipe & Run Center（Recipe 策略配置 + 运行中心）

	•	Recipe 配置模块（专注“建策略”）
	•	Run Center 模块（Run Monitor / Results / History & Templates，专注“跑与看”）

你指定：Run Monitor、结果、历史模板与建 Recipe 分开 → 本文档按此拆分。

⸻

4. 路由与导航建议（前端框架用）

4.1 顶层路由
	•	/：Home
	•	/pre-recipe：Pre-Recipe 总入口
	•	/recipe：Recipe 总入口（策略配置为主）
	•	/run-center：Run Center（监控/结果/历史/模板）

4.2 Pre-Recipe 子路由
	•	/pre-recipe/spectrum
	•	/pre-recipe/sensitivity
	•	/pre-recipe/slice-selection
	•	/pre-recipe/precision

4.3 Recipe 子路由（仅策略配置）
	•	/recipe/new：创建/输入 modelID
	•	/recipe/model：模型解析
	•	/recipe/cd-strategy：CD 策略
	•	/recipe/material：材料与模型（只读）
	•	/recipe/seed-search：Seed Search 配置
	•	/recipe/fitting-strategy：正式拟合策略
	•	/recipe/tm-kpi：TM & KPI

4.4 Run Center 子路由（运行与复用）
	•	/run-center/monitor/:runId
	•	/run-center/results/:runId
	•	/run-center/history
	•	/run-center/templates

⸻

5. 模块一：Home（主页）

5.1 目标
	•	展示平台整体定位（OCD 智能化光谱→Recipe 全流程）
	•	提供入口导航到 Pre-Recipe / Recipe / Run Center

5.2 布局建议
	•	左侧导航栏：模块入口
	•	中心区域：功能卡片/流程图式入口（Pre-Recipe → Recipe → Run Center）
	•	右侧区域（可选）：最近 Run / 最近模板 / 系统公告

⸻

6. 模块二：Pre-Recipe（光谱准备模块）

6.1 模块定位与目标

在正式建 Recipe 之前，对 DOE 光谱进行查看、分析、TEM 切片选点与 precision 评估，形成可解释的输入准备。

⸻

6.2 板块 1：光谱查看（Spectrum Viewer）

输入（前端定义）
	•	WiFiID 输入（支持多个）
	•	前端只输入 WiFiID，后端负责据此找到光谱数据

展示
	•	按 WiFiID 分组的光谱曲线集合
	•	交互：缩放、平移、图例开关、高亮

⸻

6.3 板块 2：敏感性分析（Sensitivity Analysis）

交互
	•	选择已加载的 WiFiID 集合或直接复用 Spectrum Viewer 的输入
	•	点击【Analyze】触发 API

输出（后端返回，前端展示）
	•	sensitivity 曲线图
	•	敏感波段区间（区间高亮/标注）
	•	可选择叠加回光谱查看图

⸻

6.4 板块 3：TEM 切片选点工作台（Slice Selection Workbench）

合并“选点 + 空间约束配置”，用于 TEM 切片点选择（非 TM 点）。

输入与配置
	1.	按 wafer 配置选点数量（每片 WiFiID 可不同）
	2.	Trim 半径：R_trim（例如 148mm/150mm）
	3.	区域定义：Center/Middle/Edge 的半径边界（实时校验）
	4.	区域配额：每片 wafer 在各区域选点数量（总和=该 wafer 总点数）

展示（双视图联动）
	•	光谱视图：全 DOE 光谱 + 选中光谱高亮
	•	Wafer 空间视图：2D 示意图 + 选中点高亮 + 区域环带展示

高亮模式（必须支持）
	•	整体高亮（整套方案，如 3片×3点=9条光谱）
	•	单点高亮（点击某点后仅高亮该点对应光谱/位置）

输出
	•	Slice Plan（切片方案）：配置 + 推荐点位列表（含 spectrum_id/点位信息）

⸻

6.5 板块 4：Precision 分析（Precision Evaluation）

输入
	•	指定 wafer 点（或 spectrumID/点位标识）
	•	触发 API 获取同点多次采集光谱

展示
	•	多条光谱叠加图
	•	差异可视化（可选基础指标卡）

⸻

6.6 Pre-Recipe Phase 1 交付
	•	四板块页面骨架 + 图表容器 + 输入表单 + mock 数据
	•	所有算法/数据来源以 API 占位实现

⸻

7. 模块三：Recipe 策略配置模块（仅“建策略”）

7.1 模块定位

基于工程师在厂商软件端已搭好的物理模型，通过 modelID 拉取 model.json，并在平台端完成策略配置。不负责运行监控（运行在 Run Center）。

⸻

7.2 Recipe 新建（modelID 输入页）

交互
	•	输入 modelID
	•	点击【Confirm】→ 触发 API 拉取模型信息
	•	成功后生成一个 runId 或 draftId（后端决定），进入模型解析页

⸻

7.3 Model 解析页（Model）

展示（核心：解析成表）
	1.	Basis CD 表

	•	CD 名称/ID、当前值、nominal、range、单位

	2.	Constraint CD 表

	•	CD 名称/ID、依赖 basis、关系描述、当前值

	3.	材料与模型摘要（只读）

	•	材料名、模型类型（HO/Cauchy/预留）、振子组数（若有）

⸻

7.4 CD 策略页（CD Strategy）

功能
	•	Basis CD 三分类：
	•	Master Float（必浮动）
	•	Master Fix（必固定）
	•	Maybe（可浮动）

Maybe 需要支持
	•	优先级排序（drag）
	•	grid-fixed 参数（grid range + step）
	•	批量设置 grid

Constraint scheme 自定义（用户输入）
	•	支持输入表达式（字符串）
	•	支持保存多套 scheme（A/B/C）
	•	可选择本次 run 使用哪套 scheme

⸻

7.5 材料与模型页（Material）
	•	只读为主：材料列表 + 模型类型 + HO 结构摘要
	•	作为 seed search 与 fitting 的参考页

⸻

7.6 Seed Search 配置页（Seed Search）

目标

配置材料库筛选与 seed search 参数。

功能
	•	是否筛选材料候选（默认不筛选）
	•	展示材料库 NK 曲线（供工程师勾选）
	•	seed 数量（默认 5，可改）
	•	seed search 阶段 CD 是否浮动（开关）

⸻

7.7 正式拟合策略页（Fitting Strategy）

A) 材料优化顺序
	•	默认顺序预加载
	•	支持拖拽调整（按不稳定性高优先）

B) HO 参数放开顺序（Step Sequence）
	•	展示 HO 参数矩阵（振子组 × 参数列）
	•	工程师定义每一步“放开哪些参数”
	•	提供默认模板：
	•	按列（Amplitude→EN→EG→Φ→μ）
	•	按组（第1组→第2组→…）
	•	支持完全自定义

C) Sensitivity 权重
	•	开关 + 参数占位
	•	可选关联 Pre-Recipe 敏感波段输出（占位）

D) 迭代次数与时间预估（前端展示）
	•	输入：整体迭代轮次（2/3…）
	•	页面显示“预估时间”占位（后端返回估算）

⸻

7.8 TM & KPI 页（TM & KPI）

TM 信息录入
	•	表格录入多行：
	•	WaferID
	•	SpectrumID（或点位标识）
	•	CD ID/Name（多 CD 情况）
	•	TM 值
	•	baseline 光谱选择（从已输入/已加载的 SpectrumID 中选）

KPI 定义（按 CD）
	•	最大 side-by-side bias（nm）
	•	slope 范围
	•	R² 阈值/范围
	•	支持多个 CD 各自 KPI

KPI 页面可在启动前做“必填校验”，并可从 Recipe Home 快速进入。

⸻

7.9 Recipe Phase 1 交付
	•	以上页面骨架 + 表格/表单交互 + 默认模板 + mock 数据
	•	配置内容可保存（API 占位）

⸻

8. 模块四：Run Center（运行中心：监控 / 结果 / 历史模板）

本模块与 Recipe 配置分离。进入 Run Center 需要一个 runId。

⸻

8.1 Run Monitor（运行监控页）

目标

实时查看优化状态、展示过程结果，并提供强控制能力（暂停/恢复/停止/seed 粒度控制），支持断点续跑。

页面结构
	1.	顶部状态栏

	•	run 状态：running/paused/stopped/succeeded/failed
	•	当前阶段：seed search / fitting / linearization / KPI evaluation …
	•	当前 seed、当前材料、当前 step
	•	预估剩余时间（后端返回）

	2.	控制区（必须）

	•	Pause / Resume / Stop
	•	停止某个 seed（只保留某 seed）
	•	（预留）跳过 step / 重试 step

	3.	事件时间线（Event Timeline）

	•	记录每次优化请求、返回摘要、accept/reject、reverse back、KPI 结果
	•	支持按 seed / 材料 / step 筛选

	4.	结果实时 Tabs（图表容器）

	•	Spectrum Fitting：拟合曲线
	•	Linearization/KPI：TM vs OCD 线性图 + KPI 卡片
	•	NK Curves：材料 NK 曲线（对比当前/上一次 accepted/基线，占位）

⸻

8.2 Results（结果汇总页）

目标

展示最终结果、KPI 达标情况、最优 seed/路径、策略摘要，支持保存模板/导出（占位）。

展示建议
	•	Seed 排名（GOF/KPI 综合）
	•	KPI 汇总（每个 CD KPI）
	•	最终采用策略摘要：
	•	CD 分类、Maybe priority、grid
	•	constraint scheme
	•	材料组合（seed search 输出）
	•	材料顺序 + HO step sequence
	•	过程摘要：reverse back 次数、总耗时、请求次数

⸻

8.3 Run History（历史页）
	•	历史 run 列表：modelID / runId / 时间 / 创建人 / 状态 / 最优 KPI
	•	支持：
	•	打开监控
	•	打开结果
	•	clone 策略创建新 run（生成新的 draft/run）

⸻

8.4 Templates（模板页）
	•	模板列表：标签/适用材料/创建人/更新时间
	•	支持：
	•	预览模板策略摘要
	•	一键应用创建新 run
	•	模板包含（语义）：
	•	CD Strategy
	•	constraint scheme
	•	seed search 配置
	•	fitting strategy（材料顺序 + HO step sequence）
	•	TM & KPI 配置（可选）

⸻

9. 前后端交互：API 语义占位（前端只依赖能力）

仅列能力，不规定字段。CodeX 可据此生成 mock service。

模型与草稿
	•	获取模型解析：GET /models/{modelID}
	•	创建 run/draft：POST /runs（modelID）
	•	保存各配置段：PUT /runs/{runId}/...

启动与控制
	•	start/pause/resume/stop：POST /runs/{runId}/...
	•	stop seed：POST /runs/{runId}/seeds/{seedId}/stop

状态与流
	•	status：GET /runs/{runId}/status
	•	events：GET /runs/{runId}/events
	•	artifacts（当前拟合/线性/NK）：GET /runs/{runId}/artifacts/current
	•	（可选）SSE/WebSocket：/runs/{runId}/stream

⸻

10. 前端状态与可靠性要求（必须写进框架）
	•	页面刷新不丢 run 状态（基于 runId 重拉）
	•	长任务支持断点续跑（暂停点可视化）
	•	accept/reject/revert（reverse back）路径清晰可追溯
	•	所有策略输入版本化保存，便于复用

⸻

11. Phase 1 前端交付清单（建议给 CodeX 的目标）

A) 框架层
	•	路由结构按第 4 章建立
	•	左侧导航 + 顶部面包屑 + 页面容器

B) Pre-Recipe
	•	4 个页面骨架 + Plotly 图容器 + 输入表单 + 交互联动占位

C) Recipe（策略配置）
	•	modelID 输入页
	•	model 解析页（两张 CD 表 + 材料摘要）
	•	CD 策略页（分类、排序、grid、constraint scheme 输入）
	•	Seed Search 页（材料筛选 + seed 数量 + CD 浮动开关）
	•	Fitting Strategy 页（材料顺序拖拽 + HO step sequence 配置）
	•	TM & KPI 页（表格录入 + baseline 选择 + KPI 配置）

D) Run Center
	•	Run Monitor（状态栏 + 控制区 + 时间线 + 3 个结果 Tabs 容器）
	•	Results（汇总骨架）
	•	History（列表 + 进入 monitor/results + clone）
	•	Templates（列表 + 预览 + 应用）

⸻

12. 备注
	•	model.json 字段细节与算法输出字段可后续补充，不影响 Phase 1 前端框架搭建
	•	所有页面先以 mock service 提供数据，后续替换为真实 API

⸻

如果你希望我再进一步“更适配 CodeX”，我可以在不增加你输入的情况下，补一个附录（仍然不写代码）：
	•	每个页面的组件清单（表格/表单/图/控制条/时间线）
	•	每个 API 的 mock 返回示例（用占位字段名）
这样 CodeX 生成的 UI 会更贴近你想要的结构。